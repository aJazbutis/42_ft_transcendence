{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { animate, state, style, transition, trigger } from '@angular/animations';\nimport { debounceTime, distinctUntilChanged, switchMap, tap } from 'rxjs';\nimport { FormControl } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../chat.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction DirectMessageComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"span\", 15);\n    i0.ɵɵlistener(\"click\", function DirectMessageComponent_div_12_Template_span_click_1_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r3);\n      const user_r1 = restoredCtx.$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.selectUser(user_r1));\n    });\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const user_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", user_r1.username, \" \");\n  }\n}\nexport let DirectMessageComponent = /*#__PURE__*/(() => {\n  class DirectMessageComponent {\n    constructor(chatService) {\n      this.chatService = chatService;\n      this.isOpenChange = new EventEmitter();\n      this.isDropdownOpen = false;\n      this.userSearch = new FormControl();\n    }\n    ngOnInit() {\n      this.userSearch.valueChanges.pipe(debounceTime(500), distinctUntilChanged(), switchMap(username => this.chatService.findUser(username).pipe(tap(users => {\n        this.searchedUsers = users;\n        this.isDropdownOpen = true;\n        console.log(users);\n      })))).subscribe();\n    }\n    toggle() {\n      this.isOpen = !this.isOpen;\n      this.isOpenChange.emit(this.isOpen);\n    }\n    sendMessage() {\n      if (this.messageToSend === undefined) return;\n      this.messageToSend = this.messageToSend.trim();\n      if (!this.messageToSend || !this.selectedUser) return;\n      this.chatService.sendDM(this.selectedUser?.id, this.messageToSend);\n      this.messageToSend = '';\n      this.toggle();\n    }\n    selectUser(selected) {\n      this.selectedUser = selected;\n      this.isDropdownOpen = false;\n    }\n    static #_ = this.ɵfac = function DirectMessageComponent_Factory(t) {\n      return new (t || DirectMessageComponent)(i0.ɵɵdirectiveInject(i1.ChatService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DirectMessageComponent,\n      selectors: [[\"app-direct-message\"]],\n      inputs: {\n        isOpen: \"isOpen\"\n      },\n      outputs: {\n        isOpenChange: \"isOpenChange\"\n      },\n      decls: 19,\n      vars: 5,\n      consts: [[1, \"request-password-menu-border\"], [1, \"request-password-menu\"], [1, \"title\"], [\"for\", \"user-search\"], [1, \"search-box-dropdown\"], [1, \"search-box\"], [\"type\", \"text\", \"ng-model\", \"inputText\", \"placeholder\", \"e.g. ktashbae\", \"type\", \"text\", \"id\", \"user-search\", 1, \"user-search-input\", 3, \"value\", \"formControl\"], [\"src\", \"data:image/svg+xml,%3C%3Fxml version='1.0' standalone='no'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 20010904//EN' 'http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd'%3E%3Csvg version='1.0' xmlns='http://www.w3.org/2000/svg' width='1280.000000pt' height='1280.000000pt' viewBox='0 0 1280.000000 1280.000000' preserveAspectRatio='xMidYMid meet'%3E%3Cmetadata%3E%0ACreated by potrace 1.15, written by Peter Selinger 2001-2017%0A%3C/metadata%3E%3Cg transform='translate(0.000000,1280.000000) scale(0.100000,-0.100000)'%0Afill='%234F6D7A' stroke='none'%3E%3Cpath d='M5740 12784 c-199 -42 -369 -198 -438 -399 l-27 -80 -3 -2387 -2%0A-2388 -2356 0 c-2619 0 -2435 5 -2584 -68 -104 -50 -212 -158 -263 -263 -66%0A-134 -67 -146 -67 -799 0 -651 2 -666 66 -795 69 -141 187 -243 344 -299 l85%0A-31 2387 -3 2388 -2 2 -2388 3 -2387 28 -80 c73 -206 239 -357 443 -400 101%0A-21 1207 -21 1308 0 204 43 370 194 443 400 l28 80 3 2387 2 2388 2388 2 2387%0A3 85 31 c157 56 275 158 344 299 64 129 66 144 66 795 0 653 -1 665 -67 799%0A-51 105 -159 213 -263 263 -149 73 35 68 -2584 68 l-2356 0 -2 2388 -3 2387%0A-27 80 c-70 203 -240 357 -443 400 -100 21 -1217 20 -1315 -1z'/%3E%3C/g%3E%3C/svg%3E%0A\", 1, \"dd-button\", 3, \"click\"], [\"class\", \"name\", 4, \"ngFor\", \"ngForOf\"], [1, \"message-box\"], [\"type\", \"text\", \"placeholder\", \"Message\", \"autofocus\", \"\", 3, \"ngModel\", \"ngModelChange\", \"keyup.enter\"], [1, \"send-button\", 3, \"click\"], [\"src\", \"data:image/svg+xml,%3Csvg width='30' height='30' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg'%3E%3Cmetadata id='metadata819'%3Eimage/svg+xml%3C/metadata%3E%3Cg class='layer'%3E%3Ctitle%3ELayer 1%3C/title%3E%3Cg id='layer1'%3E%3Cpath d='m25.54191,14.95809c0,-1.11962 -1,-1.5 -1,-1.5l-20,-8l3.60352,8.56055l9.39648,0.93945l-9.39648,0.93945l-3.60352,8.56055l20,-8c0,0 1,-0.38038 1,-1.5z' fill='%23e8dab2' id='rect820' stroke-miterlimit='4' stroke-width='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\"], [1, \"close\", 3, \"click\"], [1, \"name\"], [1, \"user-dropdown\", 3, \"click\"]],\n      template: function DirectMessageComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h1\", 2);\n          i0.ɵɵtext(3, \"Le Message\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"p\");\n          i0.ɵɵtext(5, \"Send a message to start a conversation\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"label\", 3);\n          i0.ɵɵtext(7, \"Search for user to message:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"div\", 4)(9, \"div\", 5);\n          i0.ɵɵelement(10, \"input\", 6);\n          i0.ɵɵelementStart(11, \"img\", 7);\n          i0.ɵɵlistener(\"click\", function DirectMessageComponent_Template_img_click_11_listener() {\n            return ctx.userSearch.reset();\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(12, DirectMessageComponent_div_12_Template, 3, 1, \"div\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"div\", 9)(14, \"textarea\", 10);\n          i0.ɵɵlistener(\"ngModelChange\", function DirectMessageComponent_Template_textarea_ngModelChange_14_listener($event) {\n            return ctx.messageToSend = $event;\n          })(\"keyup.enter\", function DirectMessageComponent_Template_textarea_keyup_enter_14_listener() {\n            return ctx.sendMessage();\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"div\", 11);\n          i0.ɵɵlistener(\"click\", function DirectMessageComponent_Template_div_click_15_listener() {\n            return ctx.sendMessage();\n          });\n          i0.ɵɵelement(16, \"img\", 12);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(17, \"button\", 13);\n          i0.ɵɵlistener(\"click\", function DirectMessageComponent_Template_button_click_17_listener() {\n            return ctx.toggle();\n          });\n          i0.ɵɵtext(18, \"Close\");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"@openClose\", ctx.isOpen ? \"open\" : \"closed\");\n          i0.ɵɵadvance(10);\n          i0.ɵɵpropertyInterpolate(\"value\", ctx.selectedUser == null ? null : ctx.selectedUser.username);\n          i0.ɵɵproperty(\"formControl\", ctx.userSearch);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.searchedUsers);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngModel\", ctx.messageToSend);\n        }\n      },\n      dependencies: [i2.NgForOf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i3.FormControlDirective],\n      styles: [\"@import\\\"https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital,opsz,wght@1,6..96,700&display=swap\\\";.request-password-menu-border[_ngcontent-%COMP%]{position:absolute;width:40%;z-index:3;border:.1dvw solid #2f424a;box-sizing:border-box;filter:drop-shadow(0 .1dvw .2dvw rgba(0,0,0,.8));left:0%}.request-password-menu[_ngcontent-%COMP%]{box-sizing:border-box;background-color:#4f6d7a;border:.7dvw solid #E8DAB2}.title[_ngcontent-%COMP%]{margin:5%;color:#2f424a;font-family:Bodoni Moda,serif;font-size:1.5dvw;text-align:center;justify-content:center}p[_ngcontent-%COMP%]{margin:0% 10% 5%;padding:0%;font-family:Quattrocento,serif;font-weight:bolder;text-align:center;color:#2f424a;font-size:.7dvw}label[_ngcontent-%COMP%]{display:block;margin-left:10%;font-size:1dvw;font-family:Quattrocento,serif;font-weight:bolder;color:#e8dab2}.search-box[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;align-items:center}input[_ngcontent-%COMP%]{display:block;margin:3% 2% 0% 10%;padding:3%;width:74%;font-size:.9dvw;font-family:Quattrocento,serif;font-weight:bolder;border:none;border-bottom:.1dvw solid #E8DAB2;background-color:#425c68;color:#e8dab2;outline:none}.dd-button[_ngcontent-%COMP%]{appearance:none;width:77%;padding:.1dvw;display:inline;cursor:pointer;white-space:nowrap;background-color:#e8dab2;border-radius:1dvw;width:.5dvw;height:.5dvw;transform:rotate(45deg)}.dd-button[_ngcontent-%COMP%]:hover{background-color:#e9d5a1}.user-dropdown[_ngcontent-%COMP%]{background-color:#e8dab2;box-sizing:border-box;border:.1dvw solid #E8DAB2;width:100%;padding:.5dvw;border:.1dvw solid #2f424a;display:flex}.user-dropdown[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#e9d5a1}button[_ngcontent-%COMP%]{color:#4f6d7a;background-color:#e8dab2;font-size:1.2dvw;font-family:Quattrocento,serif;font-weight:bolder;border:none;cursor:pointer;align-self:center;justify-self:center;height:4.5dvh;width:5.5dvw;border:.2dvh solid #2f424a}button[_ngcontent-%COMP%]:hover{background-color:#e9d5a1}.close[_ngcontent-%COMP%]{margin:0% 10% 7%}.message-box[_ngcontent-%COMP%]{box-sizing:border-box;height:15dvh;margin-top:3dvh;margin-left:2dvw;margin-right:2dvw;bottom:.9dvh;position:relative}.message-box[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{all:unset;box-sizing:border-box;resize:none;width:100%;height:100%;background-color:#e8dab2;border-radius:2dvw;border:.3dvw solid #E8DAB2;white-space:pre-wrap;word-wrap:break-word;overflow-y:auto;overflow-x:hidden;padding-left:2dvw;padding-right:5dvw;padding-top:1.6dvh;font-family:Quattrocento,serif;font-size:1.3dvw;font-weight:700;color:#423b0b;caret-color:#423b0b;scrollbar-width:none}.message-box[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border:.3dvw solid #5f5948}.send-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1.7dvw;background-color:#5f5948;border-radius:.5dvw;padding:.2dvh .3dvw;position:absolute;top:35%;right:3.5%}.send-button[_ngcontent-%COMP%]:hover{cursor:pointer}.send-button[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{background-color:#494437}\"],\n      data: {\n        animation: [trigger('openClose', [state('open', style({\n          width: '40%',\n          left: '0%'\n        })), state('closed', style({\n          width: '40%',\n          left: '-42%'\n        })), transition('open <=> closed', [animate('.7s cubic-bezier(.49,.07,.39,.93)')])])]\n      }\n    });\n  }\n  return DirectMessageComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}