{"ast":null,"code":"import { HOST_IP } from 'src/app/Constants';\nimport { ADD_ADMIN, BAN, BLOCK, GAME_INVITE, KICK, MUTE, REM_ADMIN, UNBAN, UNBLOCK } from 'src/app/chat/subscriptions-events-constants';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/chat/chat.service\";\nimport * as i2 from \"src/app/game/game.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nfunction ChannelUserComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtext(1, \"owner\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1, \"admin\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_7_ul_2_span_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"easy\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_7_ul_2_span_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"medium\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_7_ul_2_span_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"hard\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_7_ul_2_li_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 17);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_li_14_Template_li_click_0_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r13.manageUserModeration(ctx_r13.mute));\n    });\n    i0.ɵɵtext(1, \" Mute \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_7_ul_2_li_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 17);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_li_15_Template_li_click_0_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r15.manageUserModeration(ctx_r15.kick));\n    });\n    i0.ɵɵtext(1, \" Kick \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_7_ul_2_li_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 17);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_li_16_Template_li_click_0_listener() {\n      i0.ɵɵrestoreView(_r18);\n      const ctx_r17 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r17.manageUserModeration(ctx_r17.ban));\n    });\n    i0.ɵɵtext(1, \" Ban \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_7_ul_2_li_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r20 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 17);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_li_17_Template_li_click_0_listener() {\n      i0.ɵɵrestoreView(_r20);\n      const ctx_r19 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r19.manageUserModeration(ctx_r19.unban));\n    });\n    i0.ɵɵtext(1, \" Unban \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_7_ul_2_li_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 17);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_li_18_Template_li_click_0_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r21.manageUserModeration(ctx_r21.promote));\n    });\n    i0.ɵɵtext(1, \" Promote to admin \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChannelUserComponent_div_7_ul_2_li_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 17);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_li_19_Template_li_click_0_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r23.manageUserModeration(ctx_r23.demote));\n    });\n    i0.ɵɵtext(1, \" Revoke admin rights \");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function (a1) {\n  return [\"/profile\", a1];\n};\nfunction ChannelUserComponent_div_7_ul_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r26 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ul\", 12)(1, \"li\", 13);\n    i0.ɵɵtext(2, \" View profile \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"li\", 14);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_Template_li_click_3_listener() {\n      i0.ɵɵrestoreView(_r26);\n      const ctx_r25 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r25.sendGameInvite());\n    });\n    i0.ɵɵtext(4, \" Invite to \");\n    i0.ɵɵtemplate(5, ChannelUserComponent_div_7_ul_2_span_5_Template, 2, 0, \"span\", 15);\n    i0.ɵɵtemplate(6, ChannelUserComponent_div_7_ul_2_span_6_Template, 2, 0, \"span\", 15);\n    i0.ɵɵtemplate(7, ChannelUserComponent_div_7_ul_2_span_7_Template, 2, 0, \"span\", 15);\n    i0.ɵɵtext(8, \" game \");\n    i0.ɵɵelementStart(9, \"img\", 16);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_Template_img_click_9_listener($event) {\n      i0.ɵɵrestoreView(_r26);\n      const ctx_r27 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r27.toggleGameMode($event));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"li\", 17);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_Template_li_click_10_listener() {\n      i0.ɵɵrestoreView(_r26);\n      const ctx_r28 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r28.manageUserModeration(ctx_r28.block));\n    });\n    i0.ɵɵtext(11, \" Block \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"li\", 17);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_ul_2_Template_li_click_12_listener() {\n      i0.ɵɵrestoreView(_r26);\n      const ctx_r29 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r29.manageUserModeration(ctx_r29.unblock));\n    });\n    i0.ɵɵtext(13, \" Unblock \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(14, ChannelUserComponent_div_7_ul_2_li_14_Template, 2, 0, \"li\", 18);\n    i0.ɵɵtemplate(15, ChannelUserComponent_div_7_ul_2_li_15_Template, 2, 0, \"li\", 18);\n    i0.ɵɵtemplate(16, ChannelUserComponent_div_7_ul_2_li_16_Template, 2, 0, \"li\", 18);\n    i0.ɵɵtemplate(17, ChannelUserComponent_div_7_ul_2_li_17_Template, 2, 0, \"li\", 18);\n    i0.ɵɵtemplate(18, ChannelUserComponent_div_7_ul_2_li_18_Template, 2, 0, \"li\", 18);\n    i0.ɵɵtemplate(19, ChannelUserComponent_div_7_ul_2_li_19_Template, 2, 0, \"li\", 18);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(10, _c0, ctx_r3.user == null ? null : ctx_r3.user.id));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.inviteGameMode === 1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.inviteGameMode === 2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.inviteGameMode === 3);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.currentIsAdmin() && !ctx_r3.userIsAdmin() || ctx_r3.currentIsOwner());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.currentIsAdmin() && !ctx_r3.userIsAdmin() || ctx_r3.currentIsOwner());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.currentIsAdmin() && !ctx_r3.userIsAdmin() || ctx_r3.currentIsOwner());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.currentIsAdmin() && !ctx_r3.userIsAdmin() || ctx_r3.currentIsOwner());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.currentIsOwner() && !ctx_r3.userIsAdmin());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.currentIsOwner() && ctx_r3.userIsAdmin());\n  }\n}\nfunction ChannelUserComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r31 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"img\", 10);\n    i0.ɵɵlistener(\"click\", function ChannelUserComponent_div_7_Template_img_click_1_listener() {\n      i0.ɵɵrestoreView(_r31);\n      const ctx_r30 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r30.toggleDropdown());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(2, ChannelUserComponent_div_7_ul_2_Template, 20, 12, \"ul\", 11);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassProp(\"dd-button-up\", ctx_r2.isDropdownSelected);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.isDropdownSelected);\n  }\n}\nexport let ChannelUserComponent = /*#__PURE__*/(() => {\n  class ChannelUserComponent {\n    constructor(chatService, gameService, router, el) {\n      this.chatService = chatService;\n      this.gameService = gameService;\n      this.router = router;\n      this.el = el;\n      this.block = BLOCK;\n      this.unblock = UNBLOCK;\n      this.mute = MUTE;\n      this.ban = BAN;\n      this.unban = UNBAN;\n      this.kick = KICK;\n      this.promote = ADD_ADMIN;\n      this.demote = REM_ADMIN;\n      this.domain = HOST_IP;\n      this.isDropdownSelected = false;\n      this.inviteGameMode = 1;\n    }\n    toggleDropdown() {\n      this.isDropdownSelected = !this.isDropdownSelected;\n    }\n    closeDropdownOnClickOutside(event) {\n      if (this.isDropdownSelected && !this.el.nativeElement.contains(event.target)) {\n        this.isDropdownSelected = false;\n      }\n    }\n    userIsOwner() {\n      return this.channel?.owner?.id === this.user?.id;\n    }\n    currentIsOwner() {\n      return this.channel?.owner?.id === this.currentUser?.id;\n    }\n    userIsAdmin() {\n      return this.channel?.admins?.some(admin => admin.id === this.user?.id) || false;\n    }\n    currentIsAdmin() {\n      return this.channel?.admins?.some(admin => admin.id === this.currentUser?.id) || false;\n    }\n    sendDM() {\n      // Create a channel between two people\n      if (!this.user) return;\n      // I was gonna ask if you can give me a way to test if there's already a chat\n      // between two people and I was gonna make a form like you said before to compose\n      // a message but I got really sleepy.\n      this.chatService.sendDM(this.user.id, \"Hey\");\n    }\n    /* EASY: 1, MEDIUM: 2, HARD: 3 */\n    toggleGameMode(event) {\n      event.stopPropagation();\n      if (this.inviteGameMode < 3) {\n        this.inviteGameMode++;\n      } else {\n        this.inviteGameMode = 1;\n      }\n    }\n    sendGameInvite() {\n      if (!this.user) return;\n      this.chatService.sendDM(this.user.id, \"Hey, I'd like to play a game with you\", GAME_INVITE, this.inviteGameMode);\n      this.gameService.inviteToMatch(this.user.id, this.inviteGameMode);\n      this.router.navigate(['/game', {\n        invite: true,\n        accept: false\n      }]);\n    }\n    manageUserModeration(action) {\n      if (!this.user || !this.channel) return; // Just a check for typescript\n      this.chatService.manageUserModeration(action, this.user.id, this.channel?.id);\n      this.isDropdownSelected = false;\n    }\n    static #_ = this.ɵfac = function ChannelUserComponent_Factory(t) {\n      return new (t || ChannelUserComponent)(i0.ɵɵdirectiveInject(i1.ChatService), i0.ɵɵdirectiveInject(i2.GameService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i0.ElementRef));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ChannelUserComponent,\n      selectors: [[\"app-channel-user\"]],\n      hostBindings: function ChannelUserComponent_HostBindings(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵlistener(\"click\", function ChannelUserComponent_click_HostBindingHandler($event) {\n            return ctx.closeDropdownOnClickOutside($event);\n          }, false, i0.ɵɵresolveDocument);\n        }\n      },\n      inputs: {\n        user: \"user\",\n        currentUser: \"currentUser\",\n        channel: \"channel\"\n      },\n      decls: 8,\n      vars: 6,\n      consts: [[1, \"user\"], [1, \"profile-pic\"], [3, \"src\"], [1, \"name\"], [\"class\", \"owner\", 4, \"ngIf\"], [\"class\", \"admin\", 4, \"ngIf\"], [\"class\", \"dropdown\", 4, \"ngIf\"], [1, \"owner\"], [1, \"admin\"], [1, \"dropdown\"], [\"src\", \"data:image/svg+xml,%3Csvg width='1024' height='1024' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg' class='svg-icon'%3E%3Cg class='layer'%3E%3Ctitle%3ELayer 1%3C/title%3E%3Cpath d='m952.16851,329.60386l-61.40554,-60.77825c-8.91402,-8.84034 -23.15434,-9.06138 -31.77468,-0.51779l-345.12741,328.74223l-352.08794,-342.56915c-8.72982,-8.65512 -23.12058,-8.43409 -32.10828,0.48198l-61.99803,61.36767c-9.02556,8.95189 -9.24864,23.1564 -0.51779,31.81152l430.9869,419.33451c8.69196,8.65615 23.08374,8.43306 32.10827,-0.51882l61.99701,-61.36767c1.4183,-1.405 2.58999,-2.95224 3.57236,-4.5793l356.83813,-339.92901c8.65512,-8.54256 8.43307,-22.67442 -0.483,-31.47792z' fill='%234f6d7a' id='svg_1'/%3E%3C/g%3E%3C/svg%3E\", 1, \"dd-button\", 3, \"click\"], [\"class\", \"dd-menu\", 4, \"ngIf\"], [1, \"dd-menu\"], [3, \"routerLink\"], [1, \"game-invite\", 3, \"click\"], [4, \"ngIf\"], [\"src\", \"data:image/svg+xml,%3Csvg width='24' height='24' xmlns='http://www.w3.org/2000/svg' xmlns:svg='http://www.w3.org/2000/svg'%3E%3Cg class='layer'%3E%3Ctitle%3ELayer 1%3C/title%3E%3Cpath d='m20,17l-16,0m0,0l4,-4m-4,4l4,4m-4,-14l16,0m0,0l-4,-4m4,4l-4,4' fill='black' id='svg_1' stroke='%23e8dab2' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'/%3E%3C/g%3E%3C/svg%3E\", 3, \"click\"], [3, \"click\"], [3, \"click\", 4, \"ngIf\"]],\n      template: function ChannelUserComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n          i0.ɵɵelement(2, \"img\", 2);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"div\", 3);\n          i0.ɵɵtext(4);\n          i0.ɵɵtemplate(5, ChannelUserComponent_div_5_Template, 2, 0, \"div\", 4);\n          i0.ɵɵtemplate(6, ChannelUserComponent_div_6_Template, 2, 0, \"div\", 5);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(7, ChannelUserComponent_div_7_Template, 3, 3, \"div\", 6);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵpropertyInterpolate2(\"src\", \"\", ctx.domain, \"/user/image/\", ctx.user == null ? null : ctx.user.avatar, \"\", i0.ɵɵsanitizeUrl);\n          i0.ɵɵadvance(2);\n          i0.ɵɵtextInterpolate1(\" \", ctx.user == null ? null : ctx.user.username, \" \");\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.userIsOwner());\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.userIsAdmin());\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", (ctx.user == null ? null : ctx.user.id) !== (ctx.currentUser == null ? null : ctx.currentUser.id));\n        }\n      },\n      dependencies: [i4.NgIf, i3.RouterLink],\n      styles: [\".dropdown[_ngcontent-%COMP%]{position:absolute;right:5%}.user[_ngcontent-%COMP%]{position:relative;background-color:#e8dab2;padding:.5dvw;border:.1dvw solid #E8DAB2;margin-bottom:.17dvw;display:flex;align-items:center}.user[_ngcontent-%COMP%]:hover{background-color:#e9d5a1;border:.1dvw solid #e9d5a1}.dd-button[_ngcontent-%COMP%]{opacity:0%}.user[_ngcontent-%COMP%]:hover   .dd-button[_ngcontent-%COMP%]{opacity:100%;animation:_ngcontent-%COMP%_fade-in .7s 1 cubic-bezier(.075,.82,.165,1)}@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0%}to{opacity:100%}}.dropdown[_ngcontent-%COMP%]   .dd-button[_ngcontent-%COMP%]{width:.9dvw}.dd-button-up[_ngcontent-%COMP%]{width:.9dvw;opacity:100%;rotate:180deg}.dd-button[_ngcontent-%COMP%]:hover, .dd-button-up[_ngcontent-%COMP%]:hover{cursor:pointer}.profile-pic[_ngcontent-%COMP%]{display:flex;justify-content:center;width:25%}.profile-pic[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:.05dvw solid #2f424a;border-radius:50%;background-size:cover;height:2dvw;width:2dvw;object-fit:cover;object-position:center}.name[_ngcontent-%COMP%]{padding-left:0dvw;width:75%;font-family:Quattrocento,serif;font-size:1dvw;font-weight:700;color:#4f6d7a;text-overflow:ellipsis;overflow:hidden}.owner[_ngcontent-%COMP%], .admin[_ngcontent-%COMP%]{font-family:Quattrocento,serif;font-size:.7dvw;font-style:italic;font-weight:700;color:#656e71}.dd-menu[_ngcontent-%COMP%]{position:absolute;top:-.8dvw;right:1.5dvw;border:.1dvw solid #E8DAB2;border-bottom:none;padding:0;background-color:#2f424a;list-style-type:none;z-index:1;filter:drop-shadow(0 .1dvw .2dvw rgba(0,0,0,.8))}.dd-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-family:Quattrocento,serif;font-weight:700;font-size:.9dvw;color:#e8dab2;padding:.5dvw 1dvw;cursor:pointer;white-space:nowrap;border-bottom:.1dvw solid #E8DAB2}.dd-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#e8dab2;color:#2f424a}.game-invite[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.game-invite[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:.2dvw;margin-right:.2dvw}.game-invite[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-left:.4dvw;background-color:#2f424a;border-radius:50%;border:.09dvw solid #E8DAB2;height:1dvw;width:1dvw}.game-invite[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{background-color:#212e34}\"]\n    });\n  }\n  return ChannelUserComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}